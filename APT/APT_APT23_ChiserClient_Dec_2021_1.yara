rule APT_APT23_ChiserClient_Dec_2021_1
{
   meta:
        description = "Detect the ChiserClient backdoor"
        author = "Arkbird_SOLG"
        reference = "https://cyberworkx.in/2021/12/22/cyber-espionage-hackers-from-tropic-trooper-are-targeting-the-transportation-sector/"
        date = "2021-12-26"
        hash1 = "2167855743b9e488ce514c80f246fd5d0973a4296cb565f95517fa1dcfee8f74"
        hash2 = "ea2264f56ba315c4db49d06cce12365875502686f8f748570cb5a99cb213f008"
        tlp = "Clear"
        adversary = "APT23"
   strings:
        $s1 = { 48 81 ec 00 03 00 00 48 8b 05 07 ?? 04 00 48 33 c4 48 89 84 24 f0 02 00 00 48 8b da c7 44 24 50 18 00 00 00 33 ed c7 44 24 60 01 00 00 00 48 8b cb 48 89 6c 24 58 45 33 c9 4c 8d 44 24 50 48 83 c2 18 ff 15 05 ?? 03 00 85 c0 75 10 48 8b d3 e8 e1 01 00 00 8d 45 01 e9 b0 01 00 00 48 8d 53 08 48 89 bc 24 10 03 00 00 45 33 c9 4c 8d 44 24 50 48 8d 4b 10 ff 15 d3 ?? 03 00 85 c0 0f 84 71 01 00 00 33 d2 48 8d 8c 24 e0 00 00 00 41 b8 08 02 00 00 e8 [2] 00 00 ba 04 01 00 00 48 8d 8c 24 e0 00 00 00 ff 15 c3 ?? 03 00 4c 8d 05 b0 ?? 03 00 ba 04 01 }
        $s2 = { 48 83 ec 40 48 8b f9 48 8b d1 33 c9 ff 15 [2] 02 00 ff 15 [2] 02 00 83 f8 7a 75 2d 8b 0f e8 ?? 7c ff ff 48 8b d8 48 85 c0 74 4e 48 8b d7 48 8b c8 ff 15 [2] 02 00 85 c0 74 5a 48 8b c3 48 8b }
        $s3 = { 48 8b 4b 30 41 b9 00 00 00 20 41 83 c8 ff ff 15 [2] 03 00 85 c0 0f 84 6d 01 00 00 48 ff c7 48 3b fe 7c b6 48 8b 4b 30 4d 8b cf 4c 89 64 24 30 45 33 c0 89 6c 24 28 33 d2 89 6c 24 20 ff 15 [2] 03 00 85 c0 0f 84 3e 01 00 00 48 8b 4b 30 33 d2 ff 15 [2] 03 00 85 c0 0f 84 2a 01 00 00 48 8b 4b 30 48 8d 44 24 44 45 33 c9 4c 89 64 24 28 45 33 c0 48 89 44 24 20 41 8d 51 16 ff 15 [2] 03 }
        $s4 = { 48 81 ec e0 01 00 00 48 8b 05 [2] 04 00 48 33 c4 48 89 84 24 d0 01 00 00 33 f6 48 8b f9 48 89 71 08 48 89 71 10 8d 4e 50 e8 ?? 14 00 00 8d 56 02 48 8b c8 48 8b d8 e8 ?? 35 00 00 8d 4e 70 48 89 5f 08 e8 ?? 14 00 00 33 d2 48 89 44 24 20 44 8d 46 70 48 8b c8 48 8b d8 e8 ?? 61 00 00 48 89 33 8d 4e 10 48 89 73 08 48 89 73 10 89 73 18 48 89 73 20 48 89 73 28 48 89 73 30 48 89 73 38 48 89 73 40 48 89 73 48 48 89 73 50 48 89 73 58 48 89 73 60 48 89 73 68 48 89 1f e8 76 14 00 00 48 85 c0 74 1d c7 00 59 a5 1e 1d c7 40 04 63 14 81 81 c7 40 08 84 39 3b 1e c7 40 0c ad a3 1a 26 eb 03 48 8b c6 b9 02 02 00 00 48 89 47 10 48 8d 54 24 30 ff 15 [2] 03 00 b9 05 01 00 00 e8 33 14 00 00 ba 04 01 00 00 48 89 47 18 48 8b c8 ff 15 [2] 03 00 ff 15 [2] 03 00 48 8b c7 48 8b 8c 24 d0 01 00 00 48 33 cc e8 48 11 00 }
    condition:
        uint16(0) == 0x5A4D and filesize > 50KB and all of ($s*) 
}
